
@if(hasCart){
  <section class="container mx-auto px-4 py-10">
    <div class="grid-cols-1 lg:grid-cols-5 gap-8 flex">

      <!-- Área principal (Imagem + Detalhes) -->
      <div class="lg:col-span-4 space-y-6 ">
        @for(item of order?.listOrderItens; track $index){
          <section class="w-[53rem] h-80 p-4 md:p-8 bg-slate-100 rounded-lg shadow-md">
            <!-- Produto -->
            <div class="pt-4 flex flex-col md:flex-row gap-4">
              <img [src]="item.image" alt="Produto" class="w-36 h-36 object-contain">
    
              <div class="flex-1 flex flex-col gap-2 pl-6">
                <span class="text-lg text-gray-600">{{item.sellerName}}</span>
                <a href="#" class="text-xl font-semibold text-black hover:underline">
                  {{item.name}}
                </a>
                <div class="text-xs text-gray-700">
                  <p> Produto sujeito a taxa de reserva</p>
                  <p>Valor do produto: <strong>{{item.unitPrice| currency: 'BRL'}}</strong></p>
                </div>
              </div>
    
              <!-- Quantidade e preço -->
              <div class="flex flex-col items-end justify-between pl-28 ">
                <!-- Quantidade -->
                <div class="flex items-center space-x-2">
                  <p-button [ngClass]="item.quantity == 1 ?'btn-btnminus': 'btn-btnplus'" class="btn-btnplus" link [icon]="item.quantity == 1 ? 'pi pi-trash' :'pi pi-minus'" (onClick)="removeItem($index)" />
                  <p>{{item.quantity}}</p>
                  <p-button class="btn-btnplus" link icon="pi pi-plus" (onClick)="addItem($index)" />
                </div>
    
                <!-- Preço final -->
                <div class="text-right">
                  <p class="text-xs text-gray-600">Preço total do produto</p>
                  <p class="text-xl font-bold text-secondary-500">{{item.totalPrice| currency: 'BRL'}}</p>
                </div>
              </div>
            </div>
    
          </section>
        }
      </div>

      <!-- Sidebar -->
      <aside [ngClass]="loading ? 'hidden' : '' " class="lg:col-span-1 w-96 space-y-4 ">
        
      <div class=" rounded-lg shadow-md ">
        <section  
          class="flex flex-col w-full rounded-md bg-slate-100 self-start desktop:rounded-md desktop:shadow-lg desktop:p-5" 
          aria-label="Resumo">
          <!-- Título -->
          <div class="desktop:flex desktop:items-center mb-2">
            <h1 class="text-base font-bold uppercase ml-2 text-black-800 pt-5">Resumo</h1>
          </div>

          <!-- Valor dos Produtos -->
          <div class="text-sm flex justify-between items-center text-black-700 bg-slate-100 py-3 px-1 border-b border-black-100 w-5/6">
            <span>Valor dos Produtos:</span>
            <b class="text-sm text-right leading-tight text-black-800">{{order?.total | currency: 'BRL'}}</b>
          </div>

          <!-- Serviços Adicionais -->
          <div class="text-sm flex justify-between items-center text-black-700 bg-slate-100 py-3 px-1 border-b border-black-100 w-5/6">
            <span>Taxa de reserva:</span>
            <b class="text-sm text-right leading-tight text-black-800">{{order?.fee | currency: 'BRL'}}</b>
          </div>

          <!-- Local de Retirada -->
          <div class="text-sm flex justify-center text-black-700 bg-slate-100 py-3 px-1 border-b border-black-100 text-center" id="localDeRetiro">
            <div>
              <span class="block font-medium">Local de Retirada:</span>
              <div class="text-black-800 text-sm leading-tight">
                Horta tal - Rua dos bobos, 0, vila Pinho - BH
              </div>
            </div>
          </div>

          <!-- Valor total -->
          <section class=" bg-orange-100 text-green-600 px-1 py-2 mt-4 mb-2 rounded w-full" aria-labelledby="pix">
            <div class="flex justify-between">
              <span class="flex flex-col gap-1 text-sm text-green-600">
                Valor com a taxa de reserva:
              </span>
              <div class="flex flex-col items-end">
                <span class="text-sm font-bold pl-28">{{this.totalTemporario | currency: 'BRL'}}</span>
                <!-- <span class="text-xs mt-1 block text-right">(Economize: <b>R$ 28,70</b>)</span> -->
              </div>
            </div>
          </section>

        </section>
      </div>


        <div class="rounded-lg shadow-md flex flex-col items-center  bg-slate-100">
          <p-button
            class="btn-green-continue flex items-center pb-4 pt-4  text-white font-medium rounded-lg transition duration-200">
            Continuar
          </p-button>
          <p-button
            class="btn-custom-outline flex items-center pb-4 text-white font-medium rounded-lg transition duration-200" (click)="navigateToProducts()">
            Voltar
          </p-button>
        </div>
      </aside>

    </div>
  </section>
}
@else{
  <section class="h-[25rem]">
    <h1 class="text-3xl">
      O seu carrinho está vazio.
    </h1>
  </section>
}

  <p-dialog
    [(visible)]="showDialog"
    [style]="{ width: '95vw', maxWidth: '600px' }"
    header="Confirmar remoção do item do carrinho"
    [modal]="true"
    [closable]="true"
  >
    <div class="p-dialog-content">
      <p>
        Você tem certeza que deseja remover este item do carrinho?
      </p>
    </div>

    <ng-template pTemplate="footer">
      <p-button class="btn-outline-orange" type="button" label="Cancelar" icon="pi pi-times" (click)="closeConfirmDialog()"></p-button>
      <p-button class="btn-green custom" type="button" label="Confirmar" icon="pi pi-check" (click)="confirmRemoveItem(this.order!.listOrderItens, selectedProductId)"></p-button>
    </ng-template>
  </p-dialog>